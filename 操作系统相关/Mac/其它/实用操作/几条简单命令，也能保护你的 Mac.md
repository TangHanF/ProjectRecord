# 几条简单命令，也能保护你的 Mac

------

Mac 上的密码分为很多种，设置起来又很不方便，有的人因为嫌麻烦，仅仅设置了一个自我安慰的用户密码，或干脆让自己的电脑「裸奔」。

此前少数派曾写过一篇教你[用简单方法保护数据安全的文章](https://sspai.com/post/41363)，本文实现的效果类似，不过是通过更直接的命令行方式，让你像电脑高手一样保护自己的 Mac。

本文旨在带你区分不同的密码，并掌握每种密码合适的使用场合。为了避免图形界面来回切换的繁琐，我尽量介绍命令行的用法，有基础、有需求的读者可以一试，害怕把自己电脑锁上打不开的读者，权当科普便好。

## macOS 用户帐户密码

用户密码是我们最常使用的密码，即当前系统管理员密码。

涉及 Root 权限等操作都需要它的许可，比如部分系统设置、部分终端操作和安装奇奇怪怪的应用。由于能够通过某些手段绕过，可以说，用户密码**只防君子，不防小人。**

实际中我们常常需要手动输入用户密码，为了方便，长度以 6-8 位为宜，不应过长或过于复杂——但也不要太简单。我所见最奇葩的密码是「空格」，此君解锁只需猛敲两下键盘。不提倡此类故作潇洒的行为。如果需要修改密码，可以使用这个命令：

`passwd`

![img](https://cdn.sspai.com/2017/10/25/dfb216bf4ace5811fd66951f3e7587ee.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

键入原密码、新密码并确认后即修改成功。

至于配备 Touch Bar 的 MacBook，在部分情形下，它们可以使用指纹代替密码输入。但是需要注意身后徘徊的不明人员，因为有的应用会在指纹验证成功后明文显示密码（例如 iTerm 2）。

#### 👀 冷知识：我的密码失灵了？

有时开盖输入用户密码，明明正确，却无法解锁屏幕。**如果你确定 ⇪Caps Lock、⇧Shift 以及输入语言都没问题，可以重启解决。**这是 Apple 服务器的 bug，以我倒卖电脑的经验，多发于维修后、换新之后。

## Firmware 固件密码

[Firmware](https://support.apple.com/en-us/HT204455) 阻止他人从未指定的磁盘启动，包括光盘、外置 U 盘等。

这是一层非常有效的保护，防止来路不明的启动盘入侵电脑。带来的一点小麻烦是，你自己自己想重装、恢复系统之时，也得手动输入密码。

设置 Firmware 可以使用以下命令：

`sudo firmwarepasswd -setpasswd`

![img](https://cdn.sspai.com/2017/10/25/ed0d0fcdc4d4768f454d1c89905c5ad1.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

建议所有 macOS 设备都开启 Firmware。如果忘记了 Firmware，需要进入恢复模式，输入用户密码关闭 Firmware。哪天你重装系统，要是忘了许久不用的 Firmware 密码，可别再对着弹出的 Firmware 界面思考人生了。

另一种设置方式可以参考我派这篇文章：[为你的 Mac 添加「固件密码」保护](https://sspai.com/post/33355)

## FileVault 2 全磁盘加密

[FileVault](https://support.apple.com/zh-cn/HT204837)（OS X Lion 及更高版本中为 FileVault 2）防止未登入的用户读取磁盘数据。开启之后，任何账户无法自动登录FileVault 将 XTS-AES-128 加密与 256 位密钥搭配使用，几乎达到最高级别的加密，**即使别有用心之人把硬盘或 SSD 拆下来，也无法读取里面的数据。相对的，一旦登入账号，FileVault 就告解密，该账户下数据的保护需另寻出路。**

Mac 在激活和会询问你是否开启 FileVault，不少人忘了自己有没有操作过，可以用这个命令查询：

`fdesetup status`

![img](https://cdn.sspai.com/2017/10/25/078828517d649e37fdda491935273758.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

如果显示`FileVault is off`，就表示没有开启。日常使用中我不建议开启 FileVault，因为加密和解密都比较麻烦，耗时、耗电。不过，为防梁上君子，那些常常不在身边的设备建议开启 FileVault——尤其是 Mac mini 搭建的 NAS、基于 macOS 的工作站以及常驻一个地方的外置磁盘。命令如下：

`sudo fdesetup enable`

![img](https://cdn.sspai.com/2017/10/25/48056d82241c0249775bce0d25729d87.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

输入用户密码，静待加密完成**并生成 FileVault 密码，务必保管好它。**

如果你希望使用 iCloud 挽救忘记 FileVault 密码的悲惨局面，还是使用「常规方式」，在系统设置里一步步打开 FileVault：

1. 在系统设置-安全性于隐私-FileVault 内解锁左下角锁头，需要输入用户密码
2. 点选「打开 FileVault」
3. 选择是否将 FileVault 密码存储进 iCloud
4. 开始漫长的加密过程，建议连上电源

## 压缩文件加密

可以为选定的压缩包设置密码，建议用于重要的工作文件、原创作品。系统自带的压缩工具就具有加密功能，我们使用它的命令行版本。

`zip -e 文件名.zip 文件路径`

![img](https://cdn.sspai.com/2017/10/25/1b447ec4440a7f7d6a276aa87de34109.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

输入并确认密码，即刻生产带有密码保护的压缩文件。企图打开它的时候，就会问你讨要密码了。

![img](https://cdn.sspai.com/2017/10/25/fd4d1472a692577f74498859ed0dd011.gif?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1)

## 小结

密码保护远远不止于此，还有卷宗加密、网盘加密等等内容。本文所介绍的几种密码，只是比较基础的内容，但是多数人的 MacBook 仅仅有一颗聊胜于无的锁屏密码，实在令人不安。

虽然我们的生活不是《Who Am I》里的电子战场，但一些爱搞小动作的可疑分子还是让人不得不防。比起安装某些怀有司马昭之心的杀毒软件，其实用 Mac 自带工具做一些简单的预防，就能让电脑的安全系数上升不少。